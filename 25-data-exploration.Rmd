---
title: "25 - Data Exploration"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

# Structure
I am now going to explore the tidy version of the 2004-2018 Bolivia data to find factors that influence my question: who is likely to support the MAS party moving forward?

## Reading through questions
Familiarizing myself with the questions asked, so I might understand what questions and factors could be relevant using `tabyl()`

```{r, message=FALSE}
library(janitor)
library(varhandle)
```

```{r}
bolivia_clean %>% 
  tabyl(question_es)
```

```{r}
bolivia_clean %>% 
  filter(question_es == "Ideología (izquierda / derecha)")
```


```{r}
rm.all.but("bolivia_clean")
```

```{r}
numeric_wide <- bolivia_clean %>% 
  head(2200000) %>% # Get first 100K questions to reduce memory %>%
  pivot_wider(id_cols = c(person_id_factor, country, wave), 
              names_from = question_es,
              values_from = answer_measure)
```

I had to omit 2 variables, but they were unrelated to the topic, so it works out. My computer otherwise would not have had sufficient memory to widen the data.

```{r}
labelled_wide <- bolivia_clean %>% 
  head(2200000) %>% # Get first 100K questions to reduce memory %>%
  pivot_wider(id_cols = c(person_id_factor, country, wave), 
              names_from = question_es,
              values_from = answer_dimension)
```

```{r}
labelled_wide <- labelled_wide %>% 
  rename(ideology = "Ideología (izquierda / derecha)") %>% 
  rename(police_bribe = "Oficial de Policía le solicitó un soborno") %>% 
  clean_names()
```

Changing to NA values
```{r}
#Function to create NA values in Bolivia dataset
turn_to_NA <- function(country){
  country <- set_na(country, na = c("No se le preguntó en este país o año", "Not asked in this country or year","No Aplica", "No Sabe", "No sabe", "No Responde", "No responde"), as.tag = TRUE)
}

#Changing above values to NA
labelled_wide <- turn_to_NA(labelled_wide)

#Checking to make sure the function worked
labelled_wide %>% 
  select(police_bribe) %>% 
  filter(!is.na(police_bribe))
```
